version: '3'

tasks:
  dep:
    cmds:
      - flutter pub get
    silent: false

  dep:check:
    cmds:
      - flutter pub outdated

  dep:update:
    cmds:
      - flutter pub upgrade

  analyze:app:
    cmds:
      - flutter analyze lib
    silent: false

  analyze:generated:
    cmds:
      - dart run custom_lint
    silent: false

  analyze:test:
    cmds:
      - flutter analyze test
    silent: false

  gen:
    vars:
      MODE: '{{.MODE | default "build"}}'
    preconditions:
      - sh: '[[ "{{.MODE}}" == "build" || "{{.MODE}}" == "watch" ]]'
        msg: "MODEには 'build' または 'watch' を指定してください。"
    cmds:
      - dart run build_runner {{.MODE}} --delete-conflicting-outputs
    silent: false

  gen:l10n:
    cmds:
      - flutter gen-l10n
    silent: false

  run:
    cmds:
      - flutter run -d emulator-5554
    silent: false

  test:
    cmds:
      - flutter test
    silent: false

  test:integration:
    cmds:
      - flutter test integration_test
    silent: false
  