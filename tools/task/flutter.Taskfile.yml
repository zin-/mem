version: '3'

tasks:
  dep:
    desc: "依存関係を更新します。"
    cmds:
      - flutter pub get
    silent: false

  dep:check:
    desc: "依存関係を更新します。"
    cmds:
      - flutter pub outdated

  dep:update:
    desc: "依存関係を更新します。"
    cmds:
      - flutter pub upgrade

  analyze:
    desc: "Run Flutter static analysis"
    cmds:
      - flutter analyze
    silent: false

  gen:
    desc: "build_runner を実行します。MODE=build (デフォルト) または MODE=watch を指定します。"
    vars:
      MODE: '{{.MODE | default "build"}}'
    preconditions:
      - sh: '[[ "{{.MODE}}" == "build" || "{{.MODE}}" == "watch" ]]'
        msg: "MODEには 'build' または 'watch' を指定してください。"
    cmds:
      - dart run build_runner {{.MODE}} --delete-conflicting-outputs
    silent: false

  run:
    desc: "アプリを実行します。"
    cmds:
      - flutter run -d emulator-5554
    silent: false

  test:
    desc: "Run Flutter tests"
    cmds:
      - flutter test
    silent: false
  